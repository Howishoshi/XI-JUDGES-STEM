<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>XI-JUDGES STEM — Official</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --purple:#5b3ea6;
    --purple-2:#6b4bd0;
    --cream:#f5eedf;
    --max-width:1100px;
    --gap:18px;
    --muted:#666;
    --glass: rgba(255,255,255,0.6);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;
    margin:0;color:#222;background:#fff;line-height:1.45;
  }

  /* Header & nav */
  header{background:linear-gradient(180deg, rgba(91,62,166,0.06), transparent);border-bottom:1px solid rgba(0,0,0,0.05)}
  .container{max-width:var(--max-width);margin:0 auto;padding:18px}
  .topbar{display:flex;align-items:center;gap:12px}
  .logo{height:56px;max-height:64px;width:auto;object-fit:contain}
  nav{margin-left:auto}
  nav ul{display:flex;gap:14px;list-style:none;padding:0;margin:0}
  nav a{color:var(--purple);text-decoration:none;font-weight:600;cursor:pointer}
  nav a:hover{text-decoration:underline}

  /* Layout */
  .layout{display:grid;grid-template-columns:280px 1fr;gap:var(--gap);align-items:start;padding:20px}
  @media(max-width:900px){.layout{grid-template-columns:1fr;padding:12px}}

  /* Sidebar */
  .sidebar{background:linear-gradient(180deg, rgba(91,62,166,0.03), transparent);padding:14px;border-radius:8px}
  .sidebar p{margin:0;color:var(--muted)}

  /* Breadcrumbs / hero */
  .breadcrumbs{font-size:13px;color:var(--muted);margin-bottom:12px}
  .hero{position:relative;border-radius:10px;overflow:hidden;background:#222;color:#fff}
  .hero img{width:100%;height:340px;object-fit:cover;display:block}
  @media(max-width:600px){.hero img{height:190px}}

  /* Subjects & gallery */
  .subjects-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px}
  .subject-card{background:var(--cream);padding:12px;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.04)}
  .subject-card h3{margin:0 0 8px 0;color:var(--purple);font-size:18px}
  .subject-card p{margin:0;color:var(--muted);font-size:14px}
  .gallery-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:10px}
  .thumb{width:100%;aspect-ratio:16/9;background:#ddd;border-radius:6px;overflow:hidden;cursor:pointer}
  .thumb img{width:100%;height:100%;object-fit:cover;display:block}

  /* Lesson */
  .lesson{background:#fff;padding:18px;border-radius:8px}
  .lesson h1{margin:0 0 8px 0}
  .meta{color:var(--muted);font-size:14px;margin-bottom:12px}
  .content-img{width:100%;max-width:var(--max-width);aspect-ratio:16/9;overflow:hidden;margin:0 auto;border-radius:8px}
  .content-img img{width:100%;height:100%;object-fit:cover}
  .resources{display:flex;flex-direction:column;gap:8px;margin-top:12px}
  .btn{display:inline-block;padding:8px 12px;border-radius:6px;text-decoration:none;background:var(--purple);color:#fff;font-weight:600}

  /* Search & elements */
  .search{display:flex;gap:8px;margin:12px 0}
  .search input{flex:1;padding:8px;border-radius:6px;border:1px solid #ddd}
  .search button{padding:8px 12px;border-radius:6px;background:var(--cream);border:1px solid rgba(0,0,0,0.06);cursor:pointer}
  footer{padding:18px 20px;background:#faf8ff;border-top:1px solid rgba(0,0,0,0.03);text-align:center;font-size:14px;color:var(--muted)}
  .muted{color:var(--muted)}

  /* Tags */
  .tag{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(91,62,166,0.08);color:var(--purple);font-size:13px;margin:6px 6px 0 0;border:none;cursor:pointer}

  /* Modal */
  .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:9999;padding:20px}
  .modal-backdrop.active{display:flex}
  .modal-img{max-width:100%;max-height:90vh;border-radius:8px;box-shadow:0 6px 30px rgba(0,0,0,.6)}
  #modalClose{position:absolute;top:18px;right:18px;background:transparent;border:0;color:#fff;font-size:22px;cursor:pointer}

  /* Social contact buttons (polished) */
  .social-row{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
  .social-btn{
    display:inline-flex;align-items:center;gap:10px;padding:10px 16px;border-radius:999px;
    color:#fff;text-decoration:none;font-weight:700;letter-spacing:0.2px;
    box-shadow:0 8px 28px rgba(99,66,182,0.12);transition:transform .14s,box-shadow .14s,opacity .14s;
  }
  .social-btn .icon{width:20px;height:20px;display:inline-block;flex:0 0 20px}
  .social-fb{background:linear-gradient(135deg,var(--purple),var(--purple-2));}
  .social-ig{background:linear-gradient(135deg,#f58529,#dd2a7b,#8134af);background-size:200% 200%}
  .social-mail{background:#fff;color:var(--purple);border:1px solid rgba(91,62,166,0.08)}
  .social-btn:hover{transform:translateY(-4px);box-shadow:0 16px 40px rgba(99,66,182,0.18)}
  .social-btn:active{transform:translateY(-1px);opacity:.95}
  .social-mail:hover{background:var(--cream);color:var(--purple)}

  @media(max-width:640px){
    .topbar{gap:8px}
    .logo{height:44px}
    nav ul{gap:8px;font-size:14px}
  }
</style>
</head>
<body>

<header>
  <div class="container topbar">
    <!-- logo element (we will try multiple paths in JS if first fails) -->
    <img id="siteLogo" src="assets/images/logo.jpg" alt="XI-JUDGES logo" class="logo">
    <div>
      <div style="font-weight:700;color:var(--purple)">XI-JUDGES STEM</div>
      <div style="font-size:13px;color:var(--muted)">A website made by STEM students</div>
    </div>

    <nav aria-label="Main navigation">
      <ul>
        <li><a href="#home" data-route>Home</a></li>
        <li><a href="#about" data-route>About</a></li>
        <li><a href="#subjects" data-route>Subjects</a></li>
        <li><a href="#gallery" data-route>Gallery</a></li>
        <li><a href="#downloads" data-route>Downloads</a></li>
        <li><a href="#contact" data-route>Contact us</a></li>
      </ul>
    </nav>
  </div>
</header>

<main class="container">
  <div class="layout">

    <aside class="sidebar" aria-labelledby="note">
      <p id="note"><strong>NOTE</strong></p>
      <p>This website is an Emptech project made by a group of students under Ma'am Katz Escaño.</p>

      <div style="margin-top:12px">
        <div class="muted" style="font-size:13px">Search lessons</div>
        <div class="search" role="search">
          <input id="searchInput" placeholder="search lesson, subject, or tag..." aria-label="Search lessons">
          <button id="searchBtn" type="button" aria-label="Search">Search</button>
        </div>
      </div>

      <div style="margin-top:12px">
        <div class="muted" style="font-size:13px">Quick Links</div>
        <div id="filterList" style="margin-top:8px;display:flex;flex-wrap:wrap;gap:6px"></div>
      </div>
    </aside>

    <section id="mainContent">
      <div class="breadcrumbs" id="breadcrumbs">Home</div>

      <!-- Home -->
      <div id="page-home">
        <div class="hero" id="hero">
          <img id="heroImg" src="assets/images/hero/heroimg.jpg" alt="hero image">
        </div>

        <div style="margin-top:18px">
          <h2 style="margin:0 0 8px 0">Subjects</h2>
          <div class="subjects-grid" id="subjectsGrid" aria-live="polite"></div>
        </div>
      </div>

      <!-- About -->
      <div id="page-about" style="display:none">
        <h1>About</h1>
        <p>TThis website is made to guide and help STEM students, or anyone who wants to learn more about STEM subjects. You will find lessons, reviewers, summaries, videos, and other resources to make studying easier and more enjoyable. </p>
      </div>

      <!-- Subjects -->
      <div id="page-subjects" style="display:none">
        <h1 id="subjectTitle">Subjects</h1>
        <div id="subjectDesc" style="color:var(--muted);margin-bottom:12px"></div>
        <div id="lessonsList" class="subjects-grid"></div>
      </div>

      <!-- Gallery -->
      <div id="page-gallery" style="display:none">
        <h1>Gallery</h1>
        <div class="gallery-grid" id="galleryGrid"></div>
      </div>

      <!-- Downloads -->
      <div id="page-downloads" style="display:none">
        <h1>Downloads / Resources</h1>
        <div id="downloadsList"></div>
      </div>

      <!-- Contact (styled buttons) -->
      <div id="page-contact" style="display:none">
        <h1>Connect with us</h1>
        <p>Got any questions? Reach out.</p>

        <div class="social-row" role="list">
          <a role="listitem" class="social-btn social-fb" href="https://www.facebook.com/profile.php?id=61578623245383" target="_blank" rel="noopener" aria-label="XI-JUDGES on Facebook">
            <span class="icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M22 12.07C22 6.48 17.52 2 11.93 2S2 6.48 2 12.07c0 4.99 3.66 9.13 8.44 9.93v-7.03H7.9v-2.9h2.54V9.84c0-2.5 1.49-3.88 3.77-3.88 1.09 0 2.23.2 2.23.2v2.45h-1.25c-1.23 0-1.61.77-1.61 1.56v1.87h2.74l-.44 2.9h-2.3V22c4.78-.8 8.44-4.94 8.44-9.93z"/></svg>
            </span>
            <span>Facebook</span>
          </a>

          <a role="listitem" class="social-btn social-ig" href="https://www.instagram.com/xi_judges" target="_blank" rel="noopener" aria-label="XI-JUDGES on Instagram">
            <span class="icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm5 6.5A4.5 4.5 0 1 0 16.5 13 4.5 4.5 0 0 0 12 8.5zm5.5-3.8a1.08 1.08 0 1 0 1.08 1.08A1.08 1.08 0 0 0 17.5 4.7zM12 10.7A1.3 1.3 0 1 1 10.7 12 1.3 1.3 0 0 1 12 10.7z"/></svg>
            </span>
            <span>Instagram</span>
          </a>

          <a role="listitem" class="social-btn social-mail" href="mailto:xijudges@gmail.com" aria-label="Email XI-JUDGES">
            <span class="icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
            </span>
            <span>Email Us</span>
          </a>
        </div>

        <p style="margin-top:12px;color:var(--muted);font-size:14px">Don't forget to follow our socials</p>
      </div>

      <!-- Lesson view -->
      <div id="page-lesson" style="display:none">
        <div class="lesson" id="lessonView">
          <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
            <div>
              <h1 id="lessonTitle"></h1>
              <div class="meta" id="lessonMeta"></div>
            </div>
          </div>

          <div class="content-img" style="margin-top:12px">
            <img id="lessonImage" src="assets/images/content/placeholder.jpg" alt="lesson image">
          </div>

          <div style="margin-top:14px" id="lessonSummary"></div>
          <div class="resources" id="lessonResources"></div>
          <div style="margin-top:14px" id="videoContainer"></div>
        </div>
      </div>

    </section>
  </div>
</main>

<footer>
  XI-JUDGES STEM — for school purposes only. &nbsp; | &nbsp; Created by Group 4.
</footer>

<!-- Modal (lightbox) -->
<div id="modalBackdrop" class="modal-backdrop" aria-hidden="true" role="dialog" aria-label="Image preview">
  <button id="modalClose" aria-label="Close">✕</button>
  <img id="modalImage" class="modal-img" alt="Preview">
</div>

<script>
/* ---------- SITE DATA (complete lessons & subjects added) ---------- */
const SITE_DATA = {
  siteName: 'XI-JUDGES STEM',
  homeSlides:[
    'assets/hero/gallery1.jpg',
    'assets/hero/gallery2.jpg',
    'assets/hero/gallery3.jpg'
  ],
  subjects:[
    {
      id:'emptech',
      title:'Empowerment Technologies',
      short:'Applied ICT skills and content development.',
      lessons:[
        {title:'Introduction to ICT', slug:'emptech-intro-ict', summary:'Overview of ICT and its role.', youtube:['https://youtu.be/4hzcT6tMf-M?si=nVxDbXj9BTp6MHcx']},
        {title:'Rules of Netiquette', slug:'emptech-netiquette', summary:'Netiquette and online behavior.', youtube:['https://youtu.be/GXb48ztCGvI?si=7DpaVLpLZkezxC0v']},
        {title:'Advanced Word Processing', slug:'emptech-word', summary:'Word processing advanced features.', youtube:['https://youtu.be/Du8VFmfd-lc?si=bYHuSOEJuL_rp3uz']},
        {title:'Advanced Spreadsheet skills', slug:'emptech-spreadsheet', summary:'Spreadsheets for data & formulas.', youtube:['https://youtu.be/lKh_Waz8Bek?si=jsDEVnHe8HkzIZHj']},
        {title:'Advanced Presentation skills', slug:'emptech-presentation', summary:'Creating effective presentations.', youtube:['https://youtu.be/W2VZjwLzQmg?si=vJD3URpfV27ClxOy']},
        {title:'Imaging and Designing for online environment', slug:'emptech-imaging', summary:'Basics of imaging & design for web.', youtube:['https://youtu.be/AiiSGGfPQTY?si=K7CeIZmfzfEI_rEj']},
        {title:'Online platforms for ICT content development', slug:'emptech-platforms', summary:'Platforms for publishing and collaboration.', youtube:['https://youtu.be/Y-t-DLhZhw4?si=cfplIG_mtARwIfR8']},
        {title:'Basic Web Page creating', slug:'emptech-webpage', summary:'Introduction to making webpages.', youtube:['https://youtu.be/fhgCZHyYz7U?si=hjrTNwpQOgb4aIfi']},
        {title:'Collaborative ICT Development', slug:'emptech-collab', summary:'Working together on ICT projects.', youtube:['https://youtu.be/L-Ktk0xIrgw?si=diVuV_VXfoGnNKjz']},
        {title:'Interactive Multimedia', slug:'emptech-multimedia', summary:'Multimedia elements and interactivity.', youtube:['https://youtu.be/cjtvKbl9Qug?si=CDbnKtYhTpwNLsuA']},
        {title:'ICT as an agent of change', slug:'emptech-agent', summary:'ICT impacts society and change.', youtube:['https://youtu.be/Cfk4Z9AjpbU?si=wr2SU7eVfDkWurC6']},
        {title:'ICT project for social change', slug:'emptech-project', summary:'Designing ICT projects for community benefit.', youtube:['https://youtu.be/KoITSQnq2-E?si=zIhnCb4FIpzUSlWm']}
      ]
    },
    {
      id:'genbio',
      title:'General Biology 1',
      short:'Cell biology, tissues, mitosis & meiosis, evolution.',
      lessons:[
        {title:'Cell Theory', slug:'bio-cell-theory', summary:'Foundational cell theory concepts.', youtube:['https://youtu.be/iu8iqT7lUQc?si=8mtDpm7tNdFupTJy'], readingLinks:['https://codental.uobaghdad.edu.iq/wp-content/uploads/sites/14/2020/03/Cell-Theory.pdf']},
        {title:'Organelle Structure & Function', slug:'bio-organelles', summary:'Major organelles and roles.', youtube:['https://youtu.be/56kSOHc8B1E?si=OBbw6oWIueIw_3nl'], readingLinks:['https://byjus.com/biology/cells/','https://www.genome.gov/genetics-glossary/Organelle']},
        {title:'Cell Structure & Functions', slug:'bio-cell-structure', summary:'Cell components and their functions.', youtube:['https://youtu.be/6mgkoqcm6Sg?si=fE_ZcT-3mh04a2ly','https://youtu.be/t5DvF5OVr1Y?si=RejdDjqfqL4InY-D'], readingLinks:['https://www.mugberiagangadharmahavidyalaya.ac.in/images/ques_answer/1585930984BD%20Cell%20Unit%20-%201.2.pdf']},
        {title:'Animal Tissues', slug:'bio-animal-tissues', summary:'Types and functions of animal tissues.', youtube:['https://youtu.be/UlINGF9MnNA?si=LO3gc1LMkOftBbdU','https://youtu.be/OU_hmL-XxYI?si=YhCfUKX78riJyArs'], readingLinks:['https://byjus.com/biology/animal-tissue-types/','https://study.com/academy/lesson/animal-tissues-types-structure-function.html']},
        {title:'Plant Tissues', slug:'bio-plant-tissues', summary:'Plant tissue systems and roles.', youtube:['https://youtu.be/M-qDzKG3RB0?si=73y-xa2wdAF9Yx_f','https://youtu.be/A_DF246uVlU?si=I0hWkTTeqDHulYMd','https://youtu.be/gms6BrFl6mc?si=ZHNSRR5CCdtR2jcI'], readingLinks:['https://byjus.com/biology/plant-tissue-system/','https://courses.lumenlearning.com/wm-biology2/chapter/plant-tissues-and-organs/']},
        {title:'Cell Modification', slug:'bio-cell-modification', summary:'Structural modifications of cells.', youtube:['https://youtu.be/t3g26p9Mh_k?si=W5fZ1c7RQn7U2Ctq','https://youtu.be/nJ43FkoabXw?si=mLi8SyG870KSj8pY','https://youtu.be/Pvton7y5mCw?si=LNR7GMXz2nAbdOEB'], readingLinks:['https://www.slideshare.net/slideshow/lesson-4-cell-modifications/185713646']},
        {title:'Mitosis and Meiosis', slug:'bio-mitosis-meiosis', summary:'Cell division processes and stages.', youtube:['https://youtu.be/zrKdz93WlVk?si=wsUhzzclZCrL_uj0','https://youtu.be/f-ldPgEfAHI?si=59XBm17L7yvR97Rs','https://youtu.be/VzDMG7ke69g?si=qyr505K_DWMtyv-R'], readingLinks:['https://byjus.com/biology/mitosis-and-meiosis/']},
        {title:'Evolutionary Processes', slug:'bio-evolution', summary:'Mechanisms that drive evolution.', youtube:['https://youtu.be/fI7IV3x-dGI?si=S3Eo-M2P08nhr59i','https://youtu.be/gQ4hJDwllO0?si=ObwzLKGLleeyPSTr'], readingLinks:['https://bio.libretexts.org/Bookshelves/Introductory_and_General_Biology/General_Biology_1e_(OpenStax)/4%3A_Evolutionary_Processes','https://evolution.berkeley.edu/evolution-101/mechanisms-the-processes-of-evolution/']},
        {title:'Applications of Mitosis/Meiosis', slug:'bio-mitosis-app', summary:'Applications in medicine and breeding.', youtube:['https://youtu.be/56kSOHc8B1E?si=OBbw6oWIueIw_3nl']},
        {title:'Cell-cycle Disorders & Diseases', slug:'bio-cell-disorders', summary:'Diseases related to cell-cycle errors.', youtube:['https://youtu.be/dODIrlEN55g?si=8UKmfI1C5yi8_cfL','https://youtu.be/NnbkWU63toI?si=WyCsRGbTxLOWu14H','https://youtu.be/bXNQmxEvpWw?si=B1bk7LfveiUm2b_D']},
        {title:'Cell Membrane', slug:'bio-cell-membrane', summary:'Structure and function of the membrane.', youtube:['https://youtu.be/fJfTDc3WzQ8?si=Z70mBf6sC-ItDR3K']},
        {title:'Transport Mechanisms', slug:'bio-transport', summary:'Diffusion, osmosis, active transport.', youtube:['https://youtu.be/ufCiGz75DAk?si=EaxfT6AG1dxcccP7','https://youtu.be/r1Ug-UvDns0?si=jaG7HCSuudl7MEm_']},
        {title:'Enzymes', slug:'bio-enzymes', summary:'Enzyme structure, function, kinetics.', youtube:['https://youtu.be/qgVFkRn8f10?si=5hjDJuc5JfZ3Zacc']}
      ]
    },
    {
      id:'precalc',
      title:'Pre-Calculus',
      short:'Conic sections and transformations.',
      lessons:[
        {title:'Introduction to Conic Sections', slug:'precalc-conics', summary:'Overview of circles, parabolas, ellipses, hyperbolas.', youtube:['https://youtu.be/0A7RR0oy2ho?si=aVhIG6TTo7084MOC']},
        {title:'Equation of a Circle (standard)', slug:'precalc-circle-std', summary:'Equation & properties', youtube:['https://youtu.be/6r1GQCxyMKI?si=EJ7ad42B_Fo1ax6Q']},
        {title:'Transforming standard → general (circle)', slug:'precalc-circle-transform', summary:'Algebraic transformation of circle equations.', youtube:['https://youtu.be/Z-e7fcVjTiU?si=v_UiuN2agj7QwH2i']},
        {title:'Parabola (vertex at origin)', slug:'precalc-parabola-origin', summary:'Parabola properties when vertex at origin.', youtube:['https://youtube.com/shorts/JJnvxUV049A?si=NNQnuw4bRXXxYRSM']},
        {title:'Finding Parabola equation', slug:'precalc-parabola-eq', summary:'Deriving a parabola equation from points.', youtube:['https://youtu.be/KYgmOTLbuqE?si=ZsVER0esUi-fPDl8']},
        {title:'Ellipse standard equation (origin)', slug:'precalc-ellipse-origin', summary:'Ellipse geometry & standard form.', youtube:['https://youtu.be/PpMZ6RHPeTA?si=JBJ5JUut-nwkmXgi']}
      ]
    },
    {
      id:'rws',
      title:'Reading & Writing Skills',
      short:'Language skills and text analysis.',
      lessons:[
        {title:'Basic Language Skills', slug:'rws-basic', summary:'Grammar, vocabulary & usage.', youtube:['https://youtu.be/GJZmUA4MrLQ']},
        {title:'Patterns of Development', slug:'rws-patterns', summary:'Organizing paragraphs & essays.', youtube:['https://youtu.be/GtfGnzFYN_s?si=J2xw6B5HN6AnP-Qq']},
        {title:'Properties of a Well-Written Text', slug:'rws-properties', summary:'Criteria for good writing.', youtube:['https://youtu.be/sL6c8nePZTQ?si=8c7K367i_CPPzsSK']},
        {title:'Explicit & Implicit Claims', slug:'rws-claims', summary:'Identifying claims in texts.', youtube:['https://youtu.be/JtuhemMlmzk?si=0N5lEWhrfI63rrCX']}
      ]
    },
    {
      id:'eapp',
      title:'English for Academic & Professional Purposes (EAPP)',
      short:'Academic writing and presentations.',
      lessons:[
        {title:'Language in academic texts', slug:'eapp-language', summary:'Register and features of academic language.', youtube:['https://youtu.be/g-SRMHvaurA']},
        {title:'Thesis Statement', slug:'eapp-thesis', summary:'Crafting clear thesis statements.', youtube:['https://youtu.be/yK2VckxsaGM']},
        {title:'Outlining reading texts', slug:'eapp-outlining', summary:'Effective outlining techniques.', youtube:['https://youtu.be/mPCCN6K8Gjc']}
      ]
    },
    {
      id:'genchem',
      title:'General Chemistry 1',
      short:'Properties, substances and gas laws.',
      lessons:[
        {title:'Properties of Matter', slug:'chem-properties', summary:'States and properties of matter.', youtube:['https://youtu.be/VJ3b08L-0SQ']},
        {title:'Common Chemical Substances', slug:'chem-common', summary:'Examples and uses of common chemicals.', youtube:['https://youtu.be/TR2iR3CZLcw']},
        {title:'Separation Methods', slug:'chem-separation', summary:'Filtration, distillation, chromatography.', youtube:['https://youtu.be/qpZhc2Zn_TI']},
        {title:'Isotopes', slug:'chem-isotopes', summary:'Isotopes and atomic mass.', youtube:['https://youtu.be/bagegEZBtOs']},
        {title:'Gas Laws', slug:'chem-gaslaws', summary:'Boyle, Charles, combined gas laws.', youtube:['https://youtu.be/W2g2iP83JoI']}
      ]
    },
    {
      id:'kompan',
      title:'Komunikasyon at Pananaliksik sa Wika',
      short:'Filipino communication and research.',
      lessons:[
        {title:'Wika: Kahulugan at Kabuluhan', slug:'kompan-wika', summary:'Meaning and importance of language.', youtube:['https://youtu.be/uDIyH89_heY?si=SaSlEjCIRGm0vjrt']},
        {title:'Konseptong Pangwika', slug:'kompan-konsepto', summary:'Key concepts in linguistics.', youtube:['https://youtu.be/0iBG4rAMapU?si=jrjb3Op_oX4M0kDe']}
      ]
    },
    {
      id:'genmath',
      title:'General Mathematics',
      short:'Functions, rational functions, inequalities.',
      lessons:[
        {title:'Functions', slug:'gm-functions', summary:'Definition and types of functions.', youtube:['https://youtu.be/-Pr3NoB9S9k']},
        {title:'Evaluating Functions', slug:'gm-evaluate', summary:'Plugging values and interpreting.', youtube:['https://youtu.be/9lmKVSFdMHE']},
        {title:'Operation on Functions', slug:'gm-ops', summary:'Combining and composing functions.', youtube:['https://youtu.be/0Dy2H6kv_3g']}
      ]
    },
    {
      id:'hope',
      title:'HOPE',
      short:'Health-oriented PE and fitness.',
      lessons:[
        {title:'The Healthiest and Fittest Me', slug:'hope-fit', summary:'Personal fitness and wellness planning.', youtube:[]},
        {title:'Set Fitness Goal', slug:'hope-goal', summary:'SMART goals for fitness.', youtube:[]}
      ]
    }
  ]
};

/* ---------- helpers ---------- */
const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));
function esc(s){ return String(s||'').replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

/* fallback placeholder (SVG data URL) */
const PLACEHOLDER_SVG = 'data:image/svg+xml;utf8,' + encodeURIComponent(
  `<svg xmlns='http://www.w3.org/2000/svg' width='1200' height='675'><rect fill='#e9e7ff' width='100%' height='100%'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' fill='#8276b9' font-family='Poppins,Arial' font-size='28'>Image not found</text></svg>`
);

/* try sources sequentially for an <img> element */
function trySources(imgEl, sources){
  if(!imgEl || !sources || !sources.length) { if(imgEl) imgEl.src = PLACEHOLDER_SVG; return; }
  let idx = 0;
  imgEl.onerror = function(){ idx++; if(idx < sources.length) imgEl.src = sources[idx]; else imgEl.src = PLACEHOLDER_SVG; };
  imgEl.src = sources[0];
}

/* renderers */
function renderSubjectsGrid(){
  const grid = $('#subjectsGrid'); if(!grid) return;
  grid.innerHTML='';
  SITE_DATA.subjects.forEach(sub=>{
    const card = document.createElement('div'); card.className='subject-card';
    card.innerHTML = `<h3>${esc(sub.title)}</h3><p>${esc(sub.short || '')}</p><div style="margin-top:8px"><a href="#subject/${sub.id}" data-route class="btn">Open</a></div>`;
    grid.appendChild(card);
  });
}

function renderFilterList(){
  const container = $('#filterList'); if(!container) return;
  container.innerHTML='';
  SITE_DATA.subjects.forEach(s=>{
    const b = document.createElement('button'); b.className='tag'; b.type='button';
    b.textContent=s.title; b.onclick=()=>{ location.hash = `#subject/${s.id}`; };
    container.appendChild(b);
  });
}

function renderGallery(){
  const g = $('#galleryGrid'); if(!g) return;
  g.innerHTML='';
  (SITE_DATA.homeSlides || []).forEach((src,i)=>{
    const d = document.createElement('div'); d.className='thumb';
    const img = document.createElement('img'); img.alt = `gallery ${i+1}`;
    // attach fallback logic for this image
    img.onerror = ()=> { img.src = PLACEHOLDER_SVG; };
    img.src = src;
    d.appendChild(img);
    d.addEventListener('click', ()=> openModal(src));
    g.appendChild(d);
  });
}

/* modal */
const modalBackdrop = $('#modalBackdrop');
const modalImage = $('#modalImage');
$('#modalClose').addEventListener('click', ()=> { closeModal(); });
modalBackdrop.addEventListener('click', (e)=> { if(e.target === modalBackdrop) closeModal(); });
function openModal(src){
  modalImage.src = src;
  modalBackdrop.classList.add('active');
  modalBackdrop.setAttribute('aria-hidden', 'false');
}
function closeModal(){
  modalBackdrop.classList.remove('active');
  modalBackdrop.setAttribute('aria-hidden', 'true');
  modalImage.src = '';
}

/* slideshow */
let slideIndex = 0, slideTimer = null;
function startSlideshow(){
  const imgs = SITE_DATA.homeSlides || [];
  const el = $('#heroImg'); if(!el) return;
  if(!Array.isArray(imgs) || imgs.length===0){ el.src = PLACEHOLDER_SVG; return; }
  // use trySources with the homeSlides sequence
  let idx = 0;
  el.onerror = function(){ idx = (idx + 1) % imgs.length; el.src = imgs[idx]; };
  el.src = imgs[0];
  clearInterval(slideTimer);
  slideTimer = setInterval(()=> {
    slideIndex = (slideIndex + 1) % imgs.length;
    el.src = imgs[slideIndex];
  }, 8000);
}

/* routing + page renderers */
function showOnly(id){
  const pages = ['page-home','page-about','page-subjects','page-gallery','page-downloads','page-contact','page-lesson'];
  pages.forEach(p=>{ const el = document.getElementById(p); if(!el) return; el.style.display = (p===id) ? 'block' : 'none'; });
  window.scrollTo({top:0,behavior:'smooth'});
}
function setBreadcrumb(parts){ const el = $('#breadcrumbs'); if(el) el.textContent = parts.join(' > '); }
function showHome(){ showOnly('page-home'); setBreadcrumb(['Home']); }
function showAbout(){ showOnly('page-about'); setBreadcrumb(['About']); }
function showGallery(){ showOnly('page-gallery'); setBreadcrumb(['Gallery']); }
function showDownloads(){ showOnly('page-downloads'); setBreadcrumb(['Downloads']); }
function showContact(){ showOnly('page-contact'); setBreadcrumb(['Contact']); }

function showSubject(subjectId){
  const subj = SITE_DATA.subjects.find(s=>s.id===subjectId); if(!subj){ showHome(); return; }
  showOnly('page-subjects'); setBreadcrumb(['Subjects',subj.title]);
  $('#subjectTitle').textContent = subj.title;
  $('#subjectDesc').textContent = subj.short || '';
  const list = $('#lessonsList'); if(!list) return; list.innerHTML='';
  (subj.lessons || []).forEach(lesson=>{
    const c = document.createElement('div'); c.className='subject-card';
    c.innerHTML = `<h3>${esc(lesson.title)}</h3><p class="muted">${esc(lesson.summary || '')}</p><div style="margin-top:8px"><a class="btn" href="#lesson/${subj.id}/${lesson.slug}" data-route>Open lesson</a></div>`;
    list.appendChild(c);
  });
}

function showLesson(subjectId, lessonSlug){
  const subj = SITE_DATA.subjects.find(s=>s.id===subjectId); if(!subj) return showHome();
  const lesson = (subj.lessons || []).find(l=>l.slug===lessonSlug); if(!lesson) return showSubject(subjectId);
  showOnly('page-lesson'); setBreadcrumb(['Subjects',subj.title, lesson.title]);
  $('#lessonTitle').textContent = lesson.title;
  $('#lessonMeta').innerHTML = `<span class="muted">Subject: ${esc(subj.title)}</span>`;
  $('#lessonSummary').textContent = lesson.summary || '';
  // lesson image (if provided) with fallback
  const lessonImage = $('#lessonImage');
  if(lessonImage){
    if(lesson.image){
      lessonImage.onerror = ()=> { lessonImage.src = PLACEHOLDER_SVG; };
      lessonImage.src = lesson.image;
    } else {
      lessonImage.src = 'assets/images/content/placeholder.jpg';
      lessonImage.onerror = ()=> { lessonImage.src = PLACEHOLDER_SVG; };
    }
  }
  const res = $('#lessonResources'); if(res) res.innerHTML='';
  if(lesson.readingLinks && Array.isArray(lesson.readingLinks)){
    lesson.readingLinks.forEach(link=>{
      const a = document.createElement('a'); a.href = link; a.target = '_blank'; a.className='muted'; a.style.display='block';
      a.textContent = 'Reading: ' + link; res.appendChild(a);
    });
  }
  if(lesson.pdfFilename){
    const a=document.createElement('a'); a.href='assets/pdfs/'+lesson.pdfFilename; a.className='btn'; a.textContent='Download PDF';
    res.appendChild(a);
  }
  const vc = $('#videoContainer'); if(!vc) return; vc.innerHTML='';
  if(lesson.youtube && lesson.youtube.length>0){
    lesson.youtube.forEach(url=>{
      const id = makeYouTubeEmbed(url);
      if(!id) return;
      const wrap = document.createElement('div'); wrap.style.marginTop='12px';
      const iframe = document.createElement('iframe');
      iframe.width = "100%"; iframe.height = "360";
      iframe.src = `https://www.youtube.com/embed/${id}`;
      iframe.title = "YouTube video"; iframe.frameBorder = "0";
      iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share";
      iframe.allowFullscreen = true;
      wrap.appendChild(iframe); vc.appendChild(wrap);
    });
  }
}

/* youtube id */
function makeYouTubeEmbed(url){
  if(!url) return null;
  try{
    if(!url.startsWith('http') && /^[A-Za-z0-9_-]{8,}$/.test(url)) return url;
    const u = new URL(url);
    const host = u.hostname.toLowerCase();
    if(host.includes('youtu.be')) return u.pathname.slice(1).split(/[?&#]/)[0];
    if(host.includes('youtube.com')){
      if(u.searchParams.get('v')) return u.searchParams.get('v').split(/[?&]/)[0];
      const path = u.pathname || '';
      if(path.includes('/embed/')) return path.split('/embed/')[1].split(/[?&#]/)[0];
      if(path.startsWith('/shorts/')) return path.split('/shorts/')[1].split(/[?&#]/)[0];
      const segs = path.split('/').filter(Boolean);
      if(segs.length) return segs[segs.length-1].split(/[?&#]/)[0];
    }
  }catch(_){}
  const m = String(url).match(/(?:v=|\/embed\/|youtu\.be\/|\/shorts\/)([A-Za-z0-9_-]{6,})/);
  return m ? m[1] : null;
}

/* router */
function handleHash(){
  const raw = (location.hash || '').replace(/^#/, '');
  if(!raw || raw === 'home'){ showHome(); return; }
  const parts = raw.split('/').map(p=>decodeURIComponent((p||'').trim())).filter(Boolean);
  if(parts.length === 0){ showHome(); return; }
  const head = parts[0].toLowerCase();
  if(head === 'about') return showAbout();
  if(head === 'gallery') return showGallery();
  if(head === 'downloads') return showDownloads();
  if(head === 'contact') return showContact();
  if(head === 'subjects') return showHome();
  if(head === 'subject' && parts[1]) return showSubject(parts[1]);
  if(head === 'lesson' && parts[1] && parts[2]) return showLesson(parts[1], parts[2]);
  if(SITE_DATA.subjects.some(s=>s.id === head)) return showSubject(head);
  showHome();
}

/* search */
function doSearch(){
  const q = ($('#searchInput') && $('#searchInput').value || '').trim().toLowerCase();
  if(!q){ alert('Type a search term'); return; }
  for(const s of SITE_DATA.subjects){
    if(s.title && s.title.toLowerCase().includes(q)){ location.hash = `#subject/${s.id}`; return; }
    for(const l of (s.lessons || [])){
      if((l.title && l.title.toLowerCase().includes(q)) || (l.summary && l.summary.toLowerCase().includes(q))){
        location.hash = `#lesson/${s.id}/${l.slug}`; return;
      }
    }
  }
  alert('No results found');
}

/* boot */
window.addEventListener('load', ()=>{
  // If logo isn't found at default, try alternate locations
  const logoEl = document.getElementById('siteLogo');
  if(logoEl){
    trySources(logoEl, ['assets/logo.jpg','assets/images/logo.jpg','assets/images/logo.png']);
    logoEl.onerror = ()=>{ console.warn('Logo failed to load from configured locations.'); };
  }

  renderSubjectsGrid(); renderFilterList(); renderGallery(); startSlideshow(); handleHash();

  // data-route anchors
  document.body.addEventListener('click', (e)=>{
    const a = e.target.closest('a[data-route]');
    if(a){
      e.preventDefault();
      const href = a.getAttribute('href') || '';
      location.hash = href.replace(/^#/, '');
      return;
    }
    const btn = e.target.closest('#searchBtn');
    if(btn){ e.preventDefault(); doSearch(); return; }
  });

  const searchInput = $('#searchInput');
  if(searchInput) searchInput.addEventListener('keydown', (ev)=>{ if(ev.key === 'Enter'){ ev.preventDefault(); doSearch(); } });
  window.addEventListener('hashchange', handleHash);
});
</script>
</body>
</html>